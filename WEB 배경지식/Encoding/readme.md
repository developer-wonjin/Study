# 개요

- 한글 인코딩 체계가 수립되기까지는 수십 년의 세월이 걸림

# 문자 집합  과 인코딩 방식

- 문자집합(CCS, coded character set)
  - 표현해야 할 문자를 정하기 & 정해진 문자들의 순서정하기
  - 포함문자 **:** 알파벳 + 숫자 + 특수 문자 + 제어 문자(인쇄와 통신을 제어) + 각 나라 언어
- 인코딩 방식(CES, character encoding scheme)
  - 문자 집합을 컴퓨터에 저장하기 위해서 옥텟(octet, 8비트 단위, 1byte단위) 형태로 표현한 것

| 문자집합                 | 인코딩 방식                                 | 표현범위                | 포함 언어                        |
| ------------------------ | ------------------------------------------- | ----------------------- | -------------------------------- |
| ASCII코드                | ASCII (문잡집합인 동시에 인코딩방식)        | 0 ~ 127<br>0x00 ~ 0x7F  | 특수기호, 숫자, 영문             |
| ISO-8859(확장 ASCII코드) | ISO-8859 (문잡집합인 동시에 인코딩방식)     | 0 ~ 255<br/>0x00 ~ 0xFF | 서유럽(8859-1)<br>동유럽(8859-2) |
| **유니코드**             | **UTF-* 로 시작하는 방식 (* 는 8, 16, 32)** | **0 ~ 6byte**           | **전 세계**                      |



## 0.  ASCII 문자코드 (1byte 초창기 8bit)

> 최상위 bit는 사용안해서 항상 0임

| 문자종류                        | ASCII코드 값 범위(1Byte 크기로 표현 가능) | C언어 ('A')  -  1byte |
| ------------------------------- | ----------------------------------------- | --------------------- |
| ASCII코드(특수기호, 숫자, 영문) | **0**0000000 ~ **0**1111111   (0 ~ 127)   | **0**1000001          |

```
'Hello'	문자열 길이:	5
'Hello'	바이트 수:	 5
'Hello'	16진수 값:	  0x48 65 6c 6c 6f
'Hello'	10진수 값:	  72 101 108 108 111
```





## 0-1. ISO-8859-1 (-16까지 있음)

> 1byte (8bit) 를 전부 사용

| 문자종류                                                     | ISO-8859-1코드 값 범위(1Byte 크기로 표현 가능) | 표현 언어      |
| ------------------------------------------------------------ | ---------------------------------------------- | -------------- |
| 로마자 사용하는 유럽국가 포함<br>서브 버전에 따라 포함하는 국가가 다름 | 00000000 ~ 11111111   (0 ~ 255)                | 서유럽(8859-1) |



## 0-2. 한글문자집합과 인코딩

-  컴퓨터에서 한글을 표현하는 방법(조합형, 완성형)

  - 조합형 문자집합(초성, 중성, 종성에 각각에 코드를 매칭) ----deprecated 됨
    - N바이트 조합형
    - 3바이트 조합형(초성, 중성, 종성에 1바이트씩 할당, KS X 1001 표준안의 한글 채움 문자 방식과 유사)
    - 2바이트 조합형

  

  - **★완성형 문자집합 ( '가', '각', '간'과 같은 완성된 문자에 코드 매칭) **

    - 한글 표준안으로 채택됨

    - 7비트 완성형(사장됨)

    - **★2바이트 완성형**  <a href="https://icodebroker.tistory.com/7077">문자 코드표 <a>

      - 2바이트 완성형에 대한 `EUC-KR 인코딩 방식`

      

  - **★2바이트 확장 완성형 문자집합**

    - **완성형 문자집합 + 8822자 추가**

    - Microsoft가 독자적으로 확장 완성형에 대한 `CP949 인코딩방식 개발`

      

  - Java에서는 `CP949`와 `EUC-KR`이 '확장'에 관계없이 같게 취급되며, 확장 완성형을 사용하기 위해서는 `MS949`로 지정해야 한다.

  





## 1. EUC-KR(확장 CP949)

> 한국어 문자집합 표현 : 2byte
>
> ASCII 코드는 1byte로 표현할 줄 암. 따라서 호환가능

- <a href="https://icodebroker.tistory.com/7077">문자 코드표 <a>
- 코드포인트 값이 곧 인코딩 값
- 완성형 한글만 존재

```
'Hello'	       문자열 길이:	5
'안녕하세요'	문자열 길이:	5

'Hello'	       바이트 수:	  5
'안녕하세요'	바이트 수:	 10

'Hello'	       16진수 값:	  0x  48   65   6c   6c   6f
'안녕하세요'	16진수 값:	  0xbec8 b3e7 c7cf bcbc bfe4

'Hello'	       10진수 값:	   72 101 108 108 111
'안녕하세요'	10진수 값:	  190 200 179 231 199 207 188 188 191 228
```





## 2. 유니코드 문자집합

- 도입계기

  ```
  [확장 ASCII 인 ISO-8859의 문제점]
  ISO 8859-15(Latin 9)의 코드 값 0xA4 은 문자 '€'
   ISO 8859-1 (Latin 1)의 코드 값 0xA4 은 문자 '¤' 
   둘을 구별할 수 없음
  ```

  

- 공식적으로 31bit 문자집합

- 하지만 21bit 로 전 세계 문자 표현 가능

- 유니코드 값(=코드 포인트)은 보통 U+를 붙여 표시  

  - 예를 들어, 'A'의 유니코드 값은 U+0041로 표현
  - \u0041로 표기하기도 함

- U+0000 ~ U+FFFF (BMP) 안에서 왠만한 언어들은 다 커버됨

| 유니코드 문자종류                               | 유니코드 값 범위(1byte ~ 31bit 문자집합)                     | 인코딩한 값의 크기                   | 소속평명                                                     |
| ----------------------------------------------- | ------------------------------------------------------------ | ------------------------------------ | ------------------------------------------------------------ |
| ASCII 에 대응하는 문자(1byte 내)                | 0   ~  127<br/>b00000000   ~   b01111111<br>     U+0000    ~  U+00**7F** | 1byte                                | BMP기본다국어평면                                            |
| 1byte내 ~ 2바이트 미만<br>                      | 128   ~   2,047<br/>   b00000000   10000000 ~ b00000111   11111111<br>                          U+00**80**  ~  U+0**7FF** | 2byte                                | BMP기본다국어평면                                            |
| 2바이트내<br>**21bit 이내로 모든 문자표현가능** | 2,048 ~  65,535<br>    b00001000   00000000 ~  b11111111    11111111<br>                           U+0**800**  ~  U+**FFFF** | 3byte                                | BMP기본다국어평면<br/><br/><br/>U+1100 ~ 11FF : 한글 자모 <br>U+AC00 ~ D7AF: **한글 소리(완성형)** |
| 3바이트 내 ~ 3바이트 내                         | b0000001   00000000    00000000   ~   b00000001   11111111   11111111  <br>U+010000 ~ U+01FFFF | 4byte<br>**(거의 사용되지 않는다.)** | 보조 다국어평면(SMP)                                         |
| ~ 31bit                                         |                                                              | 최대 6byte                           |                                                              |



~~~
'Hello'     	   문자열 길이:	5
'안녕하세요'		문자열 길이:	5
'안녕하세요'		문자열 길이:	5 (UTF-8)

'Hello'        바이트 수:	  5
'안녕하세요'	바이트 수:	 10
'안녕하세요'	바이트 수:	 15 (UTF-8)

'Hello'        16진수 값:	  0x  48   65   6c   6c   6f
'안녕하세요'	16진수 값:	  0x  bec8 b3e7 c7cf bcbc bfe4
'안녕하세요'	16진수 값:	  0x  ec 95 88    en 85 95    ed 95 98    ec 84 b8    ec 9a 94  (UTF-8)

'Hello'        10진수 값:	   72 101 108 108 111
'안녕하세요'	10진수 값:	  190 200 179 231 199 207 188 188 191 228
'안녕하세요'	10진수 값:	  236 149 136    235 133 149    237 149 152    236 132 184    236 154 148  (UTF-8)
~~~



## 2. 유니코드를 이용한 UTF8 인코딩

>최대 6byte까지 인코딩
>
>대부분 4byte에서 처리가능
>
>거의 모든 환경에서 사용됨(윈도우, 자바, 임베디드 제외)
>
>JSON에서 단독으로 UTF-8만 쓰임

- 설계원칙

  - 1바이트로 표시된 문자의 최상위 비트는 항상 0이다.

  - 2바이트 이상으로 표시된 문자의 경우, 첫 바이트의 상위 비트들이 그 문자를 표시하는 데 필요한 바이트 수를 결정한다. 

    예를 들어서 2바이트는 110으로 시작하고, 3바이트는 1110으로 시작한다.

  - 첫 바이트가 아닌 나머지 바이트들은 상위 2비트가 항상 10이다.
  
- 자바

  - Java의 String에서 사용하는 인코딩은 UTF-16 BE(Big Endian)이다.
  - Char a = '나';
    - 유니코드 값(즉, 코드포인트)을 저장. 따라서 항상 무조건 2byte
  - String a = "나";
    - 유니코드값이 아닌 유니코드를 UTF-8로 인코딩한 결과값을 저장
    - 따라서 한글문자 하나당 3byte를 차지
  - String a = "다나가";
    - 3byte * 3 = 9byte
  - String a = "abc";
    - 1byte * 3 = 3byte

| 문자종류                          | 문자값                                                   | 유니코드 값(= 코드포인트) ,진법에 따른 값                    | UTF8 인코딩값(1~6 Byte)                                      | URL 인코딩값                      | 자바<br>String 자료형   |
| --------------------------------- | -------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | --------------------------------- | ----------------------- |
| 특수기호<br>ASCII 코드 내         | ' **!** '                                                | 33 <br/>b00000000 0xxxxxxx   <br/>b00000000  00100001 <br>0x0021<br/>**U+0021**(코드포인트)<br>\u0021(또 다른 표기) | b0xxxxxxx<br/>b**0**0100001<br>**0x 00 21**<br>인코딩 값: b**0**0100001 | %21                               | **0**0100001            |
| 특수기호<br>ASCII 코드 내         | !이외의 ", #, $, %, & 등의 특수기호                      | 위와 같은방식                                                | 위와 같은방식                                                | 위와 같은방식                     | 위와 같은방식           |
| 알파벳                            | 'A'                                                      | 65 <br/>b00000000 0xxxxxxx<br>b00000000 01000001 <br/>0x0041<br/>**U+0041**<br/> | b0xxxxxxx<br>b**0**1000001<br/>**0x 00 41**<br/><br/>인코딩 값: b**0**1000001 | A<br>URL인코딩안함, 문자값 그대로 | 위와 같은방식           |
| 알파벳, 숫자문자 등등             | A이외의 B,C,,,a,b,,,0,1,2,,,**-**, **_** , **.** , **~** | 위와 동일                                                    | 위와 동일                                                    | URL인코딩안함, 문자값 그대로      | 위와 같은방식           |
|                                   | '𝝿'                                                      | 960<br/>b00000xxx  xxxxxxxx<br>b00000**011** **11000000**<br>0x03C0<br>**U+03C0** | <br>b110xxxxx   10xxxxxx<br>b110**01111**  10**000000**<br>**0x CF 80**<br><br>인코딩 값: <br>b11001111 10000000 | %CF%80                            | 11001111   10000000     |
| 완성형 한글<br>U+AC00 ~<br>U+D7AF | '나'                                                     | 45208<br>bxxxxxxxx  xxxxxxxx<br>b10110000 10011000 0xB098<br>**U+B098** | <br>b1110xxxx  10xxxxxx  10xxxxxx <br>b**1110**1011 **10**000010 **10**011000 <br>**0x EB 82 98**<br><br/>인코딩 값: <br>b**1110**1011 **10**000010 **10**011000 | %EB%82%98                         | **문자열 한글은 3byte** |
| 이후 생략                         | 겁나많음                                                 |                                                              |                                                              |                                   |                         |



## 3. UTF-16 (자바 환경)

> ASCII와 호환X
>
> 자바, 윈도우에서 사용되어 옴
>
> 2byte표현:	일반적인 문자 U+0000 ~ U+FFFF (BMP평면)
>
> 4byte표현:	특수한 (BMP평면 이외의 평면) --> 알 거 없음
>
> 자바의 String형에 데이터를 저장할 때 사용하는 인코딩  UTF-16 BE(Big Endian)을 이용한 변형된 UTF-8을 사용한다.
>
> 다음은 JAVA에서 사용되는 변형된 UTF-8이다  <a href="https://ko.wikipedia.org/wiki/UTF-8#%EB%B3%80%ED%98%95%EB%90%9C_UTF-8">링크</a>
>
> <a href="https://codingdog.tistory.com/entry/java%EC%9D%98-String%EC%9D%80-%EC%9D%B4%EB%AA%A8%EC%A7%80%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%A0%80%EC%9E%A5%ED%95%A0%EA%B9%8C%EC%9A%94">이모지 인코딩 방법</a>
>
> <a href="https://codingdog.tistory.com/entry/java-char%ED%98%95-%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9C%BC%EB%A1%9C-2%EB%B0%94%EC%9D%B4%ED%8A%B8%EB%A5%BC-%EC%B0%A8%EC%A7%80%ED%95%9C%EB%8B%A4">2byte를 차지하는 char형</a>
>
> ```
>  유니코드 범위         인코딩된 정보
> - U+0000              11000000 10000000 (0xC080)                   
> - U+0001   ~ FFFF     BMP 평면의 문자들은 UTF-8 로 인코딩하여 저장하기 때문에 1byte ~ 3byte 값을 데이터로 기록함
> - U+010000 ~ 1FFFFF   UTF-16 인코딩한 후 UTF-8 인코딩을 한 번 더 진행
> ```

### 2byte 표현

~~~
'Hello'        문자열 길이:	5
'안녕하세요'	문자열 길이:	5

'Hello'        바이트 수:	 12
'안녕하세요'	바이트 수:	 12

'Hello'        16진수 값:	  0x  ff fe    48 00    65 00    6c 00    6c 00   6f 00  (ff fe는 리틀엔디언 BOM)
'안녕하세요'	16진수 값:	  0x  ff fe    48 c5    55 b1    58 d5    38 c1   94 c6  (ff fe는 리틀엔디언 BOM)

'Hello'        16진수 값:	  0x  fe ff    00 48    00 65    00 6c    00 6c   00 6f  (fe ff는   빅엔디언 BOM)
'안녕하세요'	16진수 값:	  0x  fe ff    48 c5    55 b1    58 d5    38 c1   94 c6  (fe ff는   빅엔디언 BOM)

'Hello'        10진수 값:	  255 254    72   0    101   0    108   0    108   0    111   0
'안녕하세요'	10진수 값:	  255 254    72 197     85 177     88 213     56 193    148 198 
~~~

### 데이터를 읽을 때 사용하는 BOM 

- 왜 쓰는거지?

`Byte Order Mark ` (읽을 때 바이트 순서표시)

>0xFFFE : 리틀엔디언 --> 오늘날의 대부분 컴퓨터가 데이터를 읽을 때 사용하는 방식
>
>0xFEFF : 빅엔디언 --> 안 중요

~~~
['안녕하세요'	데이터 저장 형태(위와 동일)]
16진수 값:	  0x  ff fe    48 c5    55 b1    58 d5    38 c1   94 c6

['안녕하세요'	데이터 읽는 순서]
ff fe (리틀엔디언)  :  0x C548 

실습~
[데이터 저장 형태]
0x 48 00
[데이터 읽는 결과]
0x 0048  이 값은 유니코드 U+0048인 'H'를 뜻함
~~~



## 4. UTF-32

- 고정 4byte 사용 
- 사용할 일 없음

## 5. 데이터베이스 인코딩

UTF-8 타입

- uft8
- utf8mb4
  - 4byte영역까지 커버하는 인코딩방법

## 3. 참고자료

- 아스키코드 표        https://ko.wikipedia.org/wiki/ASCII
- 유니코드 문자집합 https://en.wikibooks.org/wiki/Unicode/Character_reference/A000-AFFF
  - 한글은 하단 **"Hangul Syllables"** 표 참고
  - U+AC00  
  - U+AC01
  - U+AC02
  - .........(이하 생략)
  -  U+D7AF









