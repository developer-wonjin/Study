DROP TABLE T1 PURGE;

CREATE TABLE T1 (C1 VARCHAR2(1), C2 NUMBER);

INSERT INTO T1 (C1, C2) VALUES ('A', 100);
INSERT INTO T1 (C1, C2) VALUES ('A', 200);
INSERT INTO T1 (C1, C2) VALUES ('B', 100);
INSERT INTO T1 (C1, C2) VALUES ('B', NULL);
INSERT INTO T1 (C1, C2) VALUES ('B', 300);
INSERT INTO T1 (C1, C2) VALUES ('C', 250);
INSERT INTO T1 (C1, C2) VALUES ('C', NULL);

COMMIT;

SELECT C1, AVG(C2) AS AVG2
  FROM T1
 GROUP BY C1
HAVING COUNT(C2) >= 2
   AND AVG(C2) >= 150;
