DROP TABLE 주문 PURGE;
DROP TABLE 고객등급 PURGE;

CREATE TABLE 주문 (
    주문번호 NUMBER
  , 고객번호 NUMBER
  , 주문일자 VARCHAR2(8)
  , 주문금액 NUMBER
);

CREATE TABLE 고객등급 (
    등급번호     NUMBER
  , 등급명       VARCHAR2(10)
  , 최저기준금액 NUMBER
  , 최고기준금액 NUMBER
);

INSERT INTO 주문 VALUES (501, 1, '20200502',  50000);
INSERT INTO 주문 VALUES (612, 1, '20200607',  80000);
INSERT INTO 주문 VALUES (728, 1, '20200619', 120000);
INSERT INTO 주문 VALUES (904, 1, '20200630',  80000);
INSERT INTO 주문 VALUES (404, 2, '20200612',  60000);
INSERT INTO 주문 VALUES (603, 2, '20200618',  40000);
INSERT INTO 주문 VALUES (807, 2, '20200629',  70000);
INSERT INTO 주문 VALUES (912, 2, '20200715',  40000);

INSERT INTO 고객등급 VALUES (1, 'VIP'   , 300000, 999999);
INSERT INTO 고객등급 VALUES (2, 'GOLD'  , 200000, 299999);
INSERT INTO 고객등급 VALUES (3, 'SILVER', 100000, 199999);
INSERT INTO 고객등급 VALUES (4, 'BRONZE',      0,  99999);

COMMIT;

SELECT A.고객번호, B.등급명
  FROM (SELECT 고객번호, SUM(주문금액) AS 주문합계금액
          FROM 주문
         WHERE 주문일자 LIKE '202006%'
         GROUP BY 고객번호) A
     , 고객등급 B
 WHERE A.주문합계금액 BETWEEN B.최저기준금액 AND B.최고기준금액;
