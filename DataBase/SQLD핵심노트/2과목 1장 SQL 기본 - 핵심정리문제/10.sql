DROP TABLE T1 PURGE;

CREATE TABLE T1 (C1 NUMBER, C2 VARCHAR2(1), C3 NUMBER);

INSERT INTO T1 (C1, C2, C3) VALUES (1, 'A', 3000);
INSERT INTO T1 (C1, C2, C3) VALUES (2, 'B',  800);
INSERT INTO T1 (C1, C2, C3) VALUES (3, 'A', NULL);
INSERT INTO T1 (C1, C2, C3) VALUES (4, 'B', 2200);
INSERT INTO T1 (C1, C2, C3) VALUES (5, 'C', 3000);
INSERT INTO T1 (C1, C2, C3) VALUES (6, 'B', 3600);

COMMIT;

SELECT C2, AVG (C3) AS R1
  FROM T1
 WHERE C1 <= 4
 GROUP BY C2
HAVING AVG(C3) >= 2000;
