SELECT *
  FROM (SELECT JOB, TO_CHAR (HIREDATE, 'YYYY') AS YYYY, DEPTNO, SAL
          FROM EMP
         WHERE DEPTNO IN (10, 30))
 PIVOT (SUM (SAL) FOR DEPTNO IN (10, 30))
 ORDER BY JOB, YYYY;
