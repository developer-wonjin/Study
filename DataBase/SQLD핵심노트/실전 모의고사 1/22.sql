DROP TABLE 고객 PURGE;
DROP TABLE 결제 PURGE;

CREATE TABLE 고객 (
    고객번호 NUMBER PRIMARY KEY
  , 고객명   VARCHAR2(100)
);

CREATE TABLE 결제 (
    결제번호     NUMBER PRIMARY KEY
  , 고객번호     NUMBER
  , 결제일시     DATE
  , 결제상품코드 VARCHAR2(4)
);

INSERT INTO 고객 VALUES (1, '빈정욱');
INSERT INTO 고객 VALUES (2, '신재원');
INSERT INTO 고객 VALUES (3, '이수빈');
INSERT INTO 고객 VALUES (4, '김고은');
INSERT INTO 고객 VALUES (5, '정희두');

INSERT INTO 결제 VALUES (2001, 1, TO_DATE ('2020-06-01', 'YYYY-MM-DD'), 'A001');
INSERT INTO 결제 VALUES (2002, 1, TO_DATE ('2020-06-11', 'YYYY-MM-DD'), 'A002');
INSERT INTO 결제 VALUES (2003, 1, TO_DATE ('2020-06-15', 'YYYY-MM-DD'), 'B002');
INSERT INTO 결제 VALUES (2004, 3, TO_DATE ('2020-04-08', 'YYYY-MM-DD'), 'A102');
INSERT INTO 결제 VALUES (2005, 3, TO_DATE ('2020-06-12', 'YYYY-MM-DD'), 'A102');
INSERT INTO 결제 VALUES (2006, 3, TO_DATE ('2020-06-28', 'YYYY-MM-DD'), 'C104');
INSERT INTO 결제 VALUES (2007, 4, TO_DATE ('2020-07-13', 'YYYY-MM-DD'), 'B305');

COMMIT;

SELECT A.고객번호, COUNT (DISTINCT B.결제상품코드) AS 상품종류수
  FROM 고객 A INNER JOIN 결제 B
    ON B.고객번호 = A.고객번호
 GROUP BY A.고객번호;
