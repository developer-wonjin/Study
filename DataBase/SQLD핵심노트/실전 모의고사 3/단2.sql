DROP TABLE 주문 PURGE;

CREATE TABLE 주문 (고객번호  NUMBER, 주문일자  VARCHAR2(8), 주문순번  NUMBER, 주문금액  NUMBER);

ALTER TABLE 주문 ADD CONSTRAINT 주문_PK PRIMARY KEY (고객번호, 주문일자, 주문순번);

INSERT INTO 주문 VALUES (100, '20200105', 1, 20000);
INSERT INTO 주문 VALUES (100, '20200112', 1, 50000);
INSERT INTO 주문 VALUES (100, '20200427', 1, 30000);
INSERT INTO 주문 VALUES (100, '20200427', 2, 15000);
INSERT INTO 주문 VALUES (200, '20200105', 1, 25000);
INSERT INTO 주문 VALUES (200, '20200105', 2, 40000);
INSERT INTO 주문 VALUES (200, '20200320', 1, 18000);

COMMIT;

SELECT 고객번호
     , MAX (주문금액) KEEP (DENSE_RANK LAST ORDER BY 주문일자) AS 최대주문금액
  FROM 주문
 GROUP BY 고객번호;
